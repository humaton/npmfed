#!/usr/bin/env ruby

require "bundler/setup"
require "npmfed"
require "thor"
require 'colorize'

class MyCLI < Thor
  @debug = false
  desc "check NPM PACKAGE NAME", "Get list of npm package dependencies and corresponding fedora builds"
  option :create
  option :deps
  def check(name, version=nil)
    package = Npmfed::NpmPackage.new name, @debug

    puts "#{package.name}-#{package.version} dependencies:"
    puts "================================================"

    package.dependencies.each {|name, data|
      if data.nil?
        puts name + "  FAIL  ".to_s.red
      else
        puts name + "   OK  ".to_s.green + data[:builds].to_s
      end
    }
    if @debug
      puts "Koji requests " + package.koji_requests
      puts "Pkgdb requests " + package.pkgdb_requests
    end

    #If so create dir structure for rpm
    #If deps specified create alsi dir structure for deps
    
  end

  desc 'test IDES', 'Used for testing shit'
  def test(name)
  end

  desc 'download ...' , '... IDES'
  def download
  end
end

MyCLI.start(ARGV)

